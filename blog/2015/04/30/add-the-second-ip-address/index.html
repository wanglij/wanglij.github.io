
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Add the second IP address  | Lijun's Blog</title>

	<meta name="author" content="Lijun Wang"> 
	
	<meta name="description" content="The senario is like this I need my Arch Linux to be able to work in two different network environments, and I hate the idea of adding another network &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Lijun's Blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" rel="stylesheet" type="text/css">
	
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	
</head>



<body>
	<header id="header" class="inner"><h1>Lijun's Blog</h1>
<nav id="main-nav"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/archives">Archive</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</nav>


</header>

	<div id="content" class="inner"><article class="post">
	<h2 class="title">Add the Second IP Address</h2>
	<div class="entry-content"><h3>The senario is like this</h3>

<p>I need my Arch Linux to be able to work in two different network environments, and I hate the idea of adding another network adapter to it, although it is running in a VMWare virtual machine.</p>

<h3>Solution: adding new IP address</h3>

<p>It was configured to get dynamic IP address by running the following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo systemctl enable dhcpcd@net0.service</span></code></pre></td></tr></table></div></figure>


<p>Note: /usr/lib/systemd/system/dhcpcd@.service should be there if dhcpcd was installed.</p>

<p>Now add the following files:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/etc/conf.d/network@net0
</span><span class='line'>address=10.255.255.77
</span><span class='line'>netmask=24
</span><span class='line'>broadcast=10.255.255.255</span></code></pre></td></tr></table></div></figure>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/etc/systemd/system/network@net0.service
</span><span class='line'>[Unit]
</span><span class='line'>Description=Network connectivity (%i)
</span><span class='line'>Wants=network.target
</span><span class='line'>Before=network.target
</span><span class='line'>BindsTo=sys-subsystem-net-devices-%i.device
</span><span class='line'>After=sys-subsystem-net-devices-%i.device
</span><span class='line'>
</span><span class='line'>[Service]
</span><span class='line'>Type=oneshot
</span><span class='line'>RemainAfterExit=yes
</span><span class='line'>EnvironmentFile=/etc/conf.d/network@%i
</span><span class='line'>
</span><span class='line'>ExecStart=/usr/bin/ip link add link %i name %i.1 type vlan id 1
</span><span class='line'>ExecStart=/usr/bin/ip link set dev %i.1 up
</span><span class='line'>ExecStart=/usr/bin/ip addr add ${address}/${netmask} dev %i.1 broadcast ${broadcast}
</span><span class='line'>
</span><span class='line'>ExecStop=/usr/bin/ip addr flush dev %i.1
</span><span class='line'>ExecStop=/usr/bin/ip route flush dev %i.1
</span><span class='line'>ExecStop=/usr/bin/ip link set dev %i.1 down
</span><span class='line'>
</span><span class='line'>[Install]
</span><span class='line'>WantedBy=multi-user.target</span></code></pre></td></tr></table></div></figure>


<p>Then enable <a href="&#x6d;&#x61;&#x69;&#108;&#x74;&#x6f;&#x3a;&#110;&#x65;&#x74;&#x77;&#x6f;&#x72;&#107;&#x40;&#x6e;&#x65;&#116;&#48;&#46;&#x73;&#x65;&#114;&#118;&#105;&#99;&#101;&#46;">&#110;&#101;&#116;&#x77;&#x6f;&#x72;&#107;&#64;&#110;&#x65;&#116;&#48;&#46;&#x73;&#x65;&#x72;&#x76;&#x69;&#x63;&#x65;&#x2e;</a></p>
</div>


<div class="meta">
	<div class="date">








  



<time datetime="2015-04-30T22:10:53+00:00" pubdate data-updated="true"></time></div>
	


</div>
</article>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2015
 Lijun Wang 
<br>
Powered by Octopress.
</footer>
	

</body>
</html>
